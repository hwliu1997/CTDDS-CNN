function B1D=ZigZag(B,direction)

switch upper(direction)
    case 'HV' % horizontal + vertical mode
        B1D=[B(1,1)];
        B1D=[B1D B(1,2) B(2,1)];
        B1D=[B1D B(3,1) B(2,2) B(1,3)]; 
        B1D=[B1D B(1,4) B(2,3) B(3,2) B(4,1)];
        B1D=[B1D B(5,1) B(4,2) B(3,3) B(2,4) B(1,5)];
        B1D=[B1D B(1,6) B(2,5) B(3,4) B(4,3) B(5,2) B(6,1)];
        B1D=[B1D B(7,1) B(6,2) B(5,3) B(4,4) B(3,5) B(2,6) B(1,7)];
        B1D=[B1D B(1,8) B(2,7) B(3,6) B(4,5) B(5,4) B(6,3) B(7,2) B(8,1)];
        B1D=[B1D B(8,2) B(7,3) B(6,4) B(5,5) B(4,6) B(3,7) B(2,8)];
        B1D=[B1D B(3,8) B(4,7) B(5,6) B(6,5) B(7,4) B(8,3)];
        B1D=[B1D B(8,4) B(7,5) B(6,6) B(5,7) B(4,8)];
        B1D=[B1D B(5,8) B(6,7) B(7,6) B(8,5)];
        B1D=[B1D B(8,6) B(7,7) B(6,8)];
        B1D=[B1D B(7,8) B(8,7)];
        B1D=[B1D B(8,8)];
    case 'DDL' % diagonal down-left mode
        B1D=[B(1,1)];
        B1D=[B1D B(1,2)  B(2,1)];
        B1D=[B1D B(3,1)  B(2,2)  B(1,3)];
        B1D=[B1D B(1,4)  B(2,3)  B(3,2) B(4,1)];
        B1D=[B1D B(5,1)  B(4,2)  B(3,3) B(2,4)  B(1,5)];
        B1D=[B1D B(1,6)  B(2,5)  B(3,4) B(4,3)  B(5,2) B(6,1)];
        B1D=[B1D B(7,1)  B(6,2)  B(5,3) B(4,4)  B(3,5) B(2,6) B(1,7)];
        B1D=[B1D B(1,8)  B(2,7)  B(3,6) B(4,5)  B(5,4) B(6,3) B(7,2) B(8,1)];
        B1D=[B1D B(7,3)  B(6,4)  B(5,5) B(4,6)  B(3,7) B(2,8) B(1,9)];
        B1D=[B1D B(1,10) B(2,9)  B(3,8) B(4,7)  B(5,6) B(6,5)];
        B1D=[B1D B(5,7)  B(4,8)  B(3,9) B(2,10) B(1,11)];
        B1D=[B1D B(1,12) B(2,11) B(3,10) B(4,9)];
        B1D=[B1D B(3,11) B(2,12) B(1,13)];
        B1D=[B1D B(1,14) B(2,13)];
        B1D=[B1D B(1,15)];
    case 'VR' % vertical-right mode
        B1D=[B(1,1)];
        B1D=[B1D B(1,2) B(2,1)];
        B1D=[B1D B(3,1) B(2,2) B(1,3)]; 
        B1D=[B1D B(1,4) B(2,3) B(3,2) B(4,1)];
        B1D=[B1D B(5,1) B(4,2) B(3,3) B(2,4) B(1,5)];
        B1D=[B1D B(1,6) B(2,5) B(3,4) B(4,3) B(5,2) B(6,1)];
        B1D=[B1D B(7,1) B(6,2) B(5,3) B(4,4) B(3,5) B(2,6) B(1,7)];
        B1D=[B1D B(1,8) B(2,7) B(3,6) B(4,5) B(5,4) B(6,3) B(7,2) B(8,1)];
        B1D=[B1D B(8,2) B(7,3) B(6,4) B(5,5) B(4,6) B(3,7) B(2,8) B(1,9)];
        B1D=[B1D B(2,9) B(3,8) B(4,7) B(5,6) B(6,5) B(7,4) B(8,3)];
        B1D=[B1D B(8,4) B(7,5) B(6,6) B(5,7) B(4,8) B(3,9)];
        B1D=[B1D B(4,9) B(6,7) B(7,6) B(8,5)];
        B1D=[B1D B(8,6) B(7,7)];
        B1D=[B1D B(8,7)];
end



